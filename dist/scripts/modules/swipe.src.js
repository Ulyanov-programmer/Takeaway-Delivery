import{isNullOrWhiteSpaces as a}from"./general.js";var r=(i=>(i[i.Top=0]="Top",i[i.Left=1]="Left",i[i.Bottom=2]="Bottom",i[i.Right=3]="Right",i))(r||{});export var ChangePlane=(i=>(i[i.ToLeft=0]="ToLeft",i[i.ToRight=1]="ToRight",i[i.ToTop=2]="ToTop",i[i.ToBottom=3]="ToBottom",i))(ChangePlane||{});var s=(t=>(t[t.Vertical=0]="Vertical",t[t.Horizontal=1]="Horizontal",t))(s||{});export default class h{constructor(e){this.startX=0;this.startY=0;this.deltaX=0;this.deltaY=0;this.pointerMoveHandler=function(e){this.swipeableElement.style.userSelect="none",this.touchAreaElement.style.cursor="grabbing",this.swipeMove(e)}.bind(this);this.pointerUpHandler=function(){this.swipeableElement.style.userSelect="",this.touchAreaElement.style.cursor="grab",this.swipeEnd(0,!1,!0)}.bind(this);if(a(e.touchStartAreaSelector,e.swipeableElementSelector))throw new Error("[SWIPE-ELEMENT Some selector is null or white spaces!]");window.addEventListener("resize",()=>{this.checkMaxWorkWidth()}),this.touchAreaElement=document.querySelector(e.touchStartAreaSelector),this.touchAreaElement.style.touchAction="none",this.touchAreaElement.style.cursor="grab",this.swipeableElement=document.querySelector(e.swipeableElementSelector),this.elementStartX=this.getTranslateState("x"),this.elementStartY=this.getTranslateState("y"),this.swipeSensitivity=e.swipeSensitivity,this.maxWorkWidth=e.maxWorkWidth,this.minSwipeWidth=Math.trunc(this.swipeableElement.clientWidth*this.swipeSensitivity),this.minSwipeHeight=Math.trunc(this.swipeableElement.clientHeight*this.swipeSensitivity),this.changePlane=e.changePlane,this.changePlane==0||this.changePlane==1?this.changeOrientation=1:this.changeOrientation=0,this.checkMaxWorkWidth(),this.touchAreaElement.addEventListener("pointerdown",t=>{t.button==0&&(this.swipeStart(t),window.addEventListener("pointermove",this.pointerMoveHandler,!1),window.addEventListener("pointerup",this.pointerUpHandler,!1))},!1)}swipeStart(e){this.startX=e.clientX,this.startY=e.clientY}swipeMove(e){this.changeOrientation==1?(this.deltaX=this.startX-e.clientX,this.currentSide=this.deltaX>=0?1:3,this.deltaX=Math.abs(this.deltaX),this.moveX()):this.changeOrientation==0&&(this.deltaY=this.startY-e.clientY,this.currentSide=this.deltaY>=0?0:2,this.deltaY=Math.abs(this.deltaY),this.moveY())}swipeEnd(e,t,n){(this.changeOrientation==1&&e>this.minSwipeWidth||this.changeOrientation==0&&e>this.minSwipeHeight)&&(t?this.swipeableElement.classList.add("active"):this.swipeableElement.classList.remove("active"),this.touchAreaElement.classList.toggle("active"),this.swipeableElement.style.transform="",window.removeEventListener("pointermove",this.pointerMoveHandler,!1)),n&&(this.swipeableElement.style.transform="",window.removeEventListener("pointermove",this.pointerMoveHandler,!1))}moveX(e=this.deltaX){if(this.checkSwipableElementContainActive()){if(this.changePlane==0&&this.currentSide==1||this.changePlane==1&&this.currentSide==3)return;let n=`${this.changePlane==0?"+":"-"}${e}`;this.swipeableElement.style.transform=`translate3d(
				${n}px,
				${this.getTranslateState("Y")}px, 
				0)`,this.swipeEnd(e,!1)}else{if(this.changePlane==0&&this.currentSide==3||this.changePlane==1&&this.currentSide==1)return;let t;this.changePlane==1?t=this.elementStartX+e:t=this.elementStartX-e,this.swipeableElement.style.transform=`translate3d(
				${t}px, 
				${this.getTranslateState("Y")}px, 
				0)`,this.swipeEnd(e,!0)}}moveY(e=this.deltaY){if(this.checkSwipableElementContainActive()){if(this.changePlane==2&&this.currentSide==0||this.changePlane==3&&this.currentSide==2)return;let n=`${this.changePlane==3?"-":"+"}${e}`;this.swipeableElement.style.transform=`translate3d(
				${this.getTranslateState("x")}px, 
				${n}px, 
				0)`,this.swipeEnd(e,!1)}else{if(this.changePlane==3&&this.currentSide==0||this.changePlane==2&&this.currentSide==2)return;let t;this.changePlane==3?t=this.elementStartY+e:t=this.elementStartY-e,this.swipeableElement.style.transform=`translate3d(
				${this.getTranslateState("x")}px, 
				${t}px, 
				0)`,this.swipeEnd(e,!0)}}getTranslateState(e="x"){let t=e=="x"?4:5,n;try{n=parseInt(window.getComputedStyle(this.swipeableElement).getPropertyValue("transform").match(/(-?[0-9\.]+)/g)[t])}catch(i){n=0}return n}checkBaseStateIsNegative(e="x"){return!(this.getTranslateState(e)>=0)}checkSwipableElementContainActive(){return this.swipeableElement.classList.contains("active")}checkMaxWorkWidth(){window.innerWidth<=this.maxWorkWidth?this.touchAreaElement.style.pointerEvents="auto":this.touchAreaElement.style.pointerEvents="none"}}
