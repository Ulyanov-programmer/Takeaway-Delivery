import{sleep as l,elementIsExistWithLog as a}from"./general.js";export var ToggleTabsEvent=(e=>(e[e.Click=0]="Click",e[e.Hover=1]="Hover",e))(ToggleTabsEvent||{});export default class r{constructor(t){this.isToggling=!1;this.toggleTabsEvent="click";this.containerHeight=0;var s,i,o;if(!a("Tab",t.btnsSelector,t.contentBlocksSelector))return;if(this.buttons=document.querySelectorAll(t.btnsSelector),this.contentElements=document.querySelectorAll(t.contentBlocksSelector),this.buttons.length!=this.contentElements.length){console.log("[Tab] The count of buttons and content-elements is not equal.");return}this.buttonsActiveClass=(s=t.buttonsActiveClass)!=null?s:"active",this.contentActiveClass=(i=t.contentActiveClass)!=null?i:"active",this.autoHeight=(o=t.autoHeight)!=null?o:!1,t.firstButtonIsNotActive||this.buttons[0].classList.add(this.buttonsActiveClass),this.contentElements[0].classList.add(this.contentActiveClass);let e=document.querySelector(t.contentBlocksSelector);if(this.parentOfContentElements=e.parentElement,t.animationDuration?this.animationDuration=t.animationDuration:this.animationDuration=parseFloat(getComputedStyle(e).getPropertyValue("transition-duration"))*1e3,this.switchingLockTime=this.animationDuration,this.setToggleTabsEvent(t.toggleTabsBy),t.fadeEffect){this.setFadeTabs(),this.resizeFadeTabs(),window.addEventListener("resize",this.resizeFadeTabs.bind(this));for(let n of this.buttons)n.addEventListener(this.toggleTabsEvent,()=>this.toggleTabsFade(n))}else{this.setDefaultTabs(),this.resizeTabs(),window.addEventListener("resize",this.resizeTabs.bind(this));for(let n of this.buttons)n.addEventListener(this.toggleTabsEvent,()=>this.toggleTabs(n))}}setFadeTabs(){let t=0;for(let e of this.contentElements)!this.autoHeight&&e.clientHeight>this.containerHeight?this.containerHeight=e.clientHeight:this.autoHeight&&this.containerHeight<=0&&(this.containerHeight=this.contentElements[0].clientHeight),e.classList.contains(this.contentActiveClass)==!1&&(e.style.opacity="0",e.style.pointerEvents="none"),e.style.transform=`translateY(-${t}px)`,t+=e.clientHeight;this.parentOfContentElements.style.overflow="hidden",this.setContainerHeight(this.containerHeight),this.parentOfContentElements.style.transition=`height ${this.animationDuration}ms`;for(let e of this.contentElements)e.style.transition=`opacity ${this.animationDuration}ms`}setDefaultTabs(){for(let t of this.contentElements)t.classList.contains(this.contentActiveClass)==!1&&(t.setAttribute("hidden",""),t.style.display="none",t.style.opacity="0",t.style.pointerEvents="none"),t.style.transition=`opacity ${this.animationDuration}ms`,this.setContainerHeight(),this.parentOfContentElements.style.transition=`height ${this.animationDuration}ms`}resizeFadeTabs(){let t=this.getCurrentActiveTab(),e=0;t?this.parentOfContentElements.style.height=`${t.clientHeight}px`:this.parentOfContentElements.style.height=`${this.contentElements[0].clientHeight}px`;for(let s of this.contentElements)s.style.transform=`translateY(-${e}px)`,e+=s.clientHeight}resizeTabs(){let t=this.getCurrentActiveTab();t?this.parentOfContentElements.style.height=`${t.clientHeight}px`:this.parentOfContentElements.style.height=`${this.contentElements[0].clientHeight}px`}toggleTabsFade(t){if(this.toggleTogglingStateIfPossible(t)==!1)return;this.toggleTabButtons(t);let e=this.getCurrentActiveTab(),s=this.getTabByPressedButton(t);e.style.opacity="0",e.style.pointerEvents="none",this.autoHeight&&this.setContainerHeight(s.clientHeight),s.style.opacity="1",s.style.removeProperty("pointer-events"),e.classList.remove(this.contentActiveClass),s.classList.add(this.contentActiveClass),setTimeout(()=>{this.isToggling=!1},this.switchingLockTime)}async toggleTabs(t){if(this.toggleTogglingStateIfPossible(t)==!1)return;this.toggleTabButtons(t);let e=this.getCurrentActiveTab(),s=this.getTabByPressedButton(t);e.classList.remove(this.contentActiveClass),e.style.opacity="0",e.style.pointerEvents="none",await l(this.animationDuration),e.setAttribute("hidden",""),e.style.display="none",s.removeAttribute("hidden"),s.style.removeProperty("pointer-events"),s.style.display="",this.setContainerHeight(s.clientHeight),await l(20),s.style.opacity="1",s.classList.add(this.contentActiveClass),setTimeout(()=>{this.isToggling=!1},this.switchingLockTime)}toggleTabButtons(t){for(let e of this.buttons)e!=t?e.classList.remove(this.buttonsActiveClass):e.classList.add(this.buttonsActiveClass)}toggleTogglingStateIfPossible(t){return t.classList.contains(this.buttonsActiveClass)||this.isToggling?!1:(this.isToggling=!0,!0)}getCurrentActiveTab(){for(let t of this.contentElements)if(t.classList.contains(this.contentActiveClass))return t;return this.contentElements[0]}getTabByPressedButton(t){return this.contentElements[t.dataset.toggleElemNumber]}setContainerHeight(t){t?this.parentOfContentElements.style.height=`${t}px`:this.parentOfContentElements.style.height=`${this.contentElements[0].clientHeight}px`}setToggleTabsEvent(t){switch(t){case 1:this.toggleTabsEvent="mouseenter",this.switchingLockTime=0;break;default:this.toggleTabsEvent="click";break}}}
